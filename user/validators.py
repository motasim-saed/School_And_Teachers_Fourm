# في user/validators.py

from django.core.exceptions import ValidationError
from django.core.validators import RegexValidator, FileExtensionValidator
import os

# ===================================================================
# 1. التحقق من صحة الأسماء (First Name, Last Name)
# ===================================================================
# هذا المتحقق يضمن أن الاسم يبدأ بحرف كبير ويحتوي على حروف فقط.
# ملاحظة: هذا قد لا يناسب كل الأسماء العربية، يمكن تبسيطه إذا أردت.
validate_name_format = RegexValidator(
    regex=r'^[A-ZА-ЯЁ][a-zA-Zа-яА-ЯёЁ\s]*$',
    message='الاسم يجب أن يبدأ بحرف كبير ويحتوي على حروف ومسافات فقط.'
)


# ===================================================================
# 2. التحقق من امتداد الصور المسموح بها
# ===================================================================
# هذا يضمن أن الصور المرفوعة هي فقط من نوع png, jpg, jpeg.
validate_image_extension = FileExtensionValidator(
    allowed_extensions=['png', 'jpg', 'jpeg'],
    message='امتداد الصورة غير مدعوم. الامتدادات المسموح بها هي: .png, .jpg, .jpeg'
)


# ===================================================================
# 3. التحقق من امتداد ملفات السيرة الذاتية (CV)
# ===================================================================
# هذا يضمن أن ملف السيرة الذاتية هو من نوع PDF فقط.
validate_cv_extension = FileExtensionValidator(
    allowed_extensions=['pdf','doc'],
    message='امتداد ملف السيرة الذاتية غير مدعوم. يجب أن يكون الملف من نوع .pdf'
)

# ===================================================================
# 4. (اختياري ومتقدم) التحقق من حجم الملف
# ===================================================================
def validate_file_size(value):
    """
    يتحقق من أن حجم الملف لا يتجاوز حداً معيناً (مثال: 5 ميجابايت).
    """
    filesize = value.size
    
    if filesize > 20 * 1024 * 1024: # 5MB
        raise ValidationError("حجم الملف كبير جداً. الحجم الأقصى المسموح به هو 5 ميجابايت.")
    else:
        return value
